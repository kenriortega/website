---
title: 'Introducci칩n a Redis parte 3'
date: '2021-10-25'
tags:
  - '游눹 Development'
  - 'Redis'
  - 'Security'
  - 'ACL'
---


En el art칤culo anterior [Introducci칩n a Redis parte 2](https://kenridev.vercel.app/blog/redis-serie-part-2) mostramos como aplicar medidas de seguridad a nuestra base de datos redis. Hoy trabajaremos con las [ACL](https://redis.io/topics/acl) Redis. Esta configuraci칩n puede ser ejecutada a trav칠s de la l칤nea de comandos del `redis-cli` o a trav칠s del archivo de configuraci칩n `redis/acl.conf`


## Introducci칩n

A partir de la versi칩n 6 de redis se encuentran disponibles las caracter칤sticas y funcionalidades para hacer uso de las ACL o listas de control de acceso, aqu칤 te comparto algunos de sus beneficios.

- Restrici칩n de ***commands*** y ***keys***
- Permite mitigar da침os si un usuario y contrase침a ha sido comprometido
- Reduce el impacto ante errores

Generalmente en nuestro d칤a a d칤a solemos trabajar con redis sin hacer uso de las listas de control de acceso ya que accedemos a nuestra base de datos con el usuario **default** y en ocasiones con un **password** como vimos en el art칤culo anterior. El d칤a de hoy ampliaremos nuestros recusos en funci칩n de nuestro futuro proyecto y debemos sentar las bases para que este escale eficientemente.

Supongamos que tenemos tres posibles casos de usos para generar nuestras ACL.

- Usuario **kdev** *desarrollador*
- Usuario **kadmin** *administrador*
- Usuario **kworker** *worker service*
- Usuario **default** nativo de la base de datos redis.

![Redis pub/sub](/redis/redis-roles.png)

Cuando trabajamos con las ACL una medida de seguridad que se recomienda es deshabilitar el usario de redis por defecto.

```bash
acl setuser default off
```

### Creando nuestras primeras acl

Crearemos una acl para nuestro usuario con rol desarrollador. Hay que tener claro que no tendr치 permisos administrativos ya que no los requiere. Los permisos que tendremos en cuenta para este caso de uso especificado ser치n:

- crear y leer cualquier tipo de *keys*
- leer y escribir los accesos y testear sus aplicaciones con redis.

```bash
acl setuser kdev on >password allcommands -@dangerous +alc|whoaimi allkeys
```

Procedamos a crear la acl para nuestro usuario con rol Administrador. Los permisos que tendremos en cuenta para este caso de uso ser치n:

- Administrar redis
- Configurar usuarios
- Asistencia ante errores

```bash
acl setuser kadmin on >passwordadmin +@admin
```

Para nuestro usuario con rol *worker*. Los permisos que tendremos en cuenta para este caso de uso ser치n:

- SET *keys*
- GET *keys*

```bash
acl setuser worker on >passwordworker +set +get ~notifications:*
```
Como se puede observar en esta 칰ltima acl adem치s de restringir los commandos que podr치 ejecutar este usuario definimos el 치mbito de alcanse que tendr치 para la lectura de las *keys* que manejar치 nuesta aplicaci칩n. He aqu칤 una imagen para ilustrar el caso de uso enfocado a un servicio de notificaciones a trav칠s de `pub/sub`.

![Redis pub/sub](/redis/redis-pubsub.png)

#### Trabajando con el `acl.conf`

```toml

vim acl.conf

....
#acl user default off
#acl user kenriortega on #atWgn4Xn4HwNUbtzoVxAYxkiYBi7aufl4MILv1nxBqR4L6NNzI0X6cE allcommands -@dangerous +alc|whoaimi allkeys
#acl user kadmin on #atWgn4Xn4HwNUbtzoVxAYxkiYBi7aufl4MILv1nxBqR4L6NNzI0X6cE +@admin
#acl user worker on #atWgn4Xn4HwNUbtzoVxAYxkiYBi7aufl4MILv1nxBqR4L6NNzI0X6cE +set +get ~notifications:allkeys
```

#### Conclusi칩n

A trav칠s de este tutorial, pudimos configurar nuestras ACL en Redis. Pudimos extrapolar diferentes casos de usos los cuales en futuros art칤culos jugar치n un papel importante en la construcci칩n de nuestra aplicaci칩n.

Llegado a este punto ya nos encontramos en condiciones para usar nuestra base de datos en futuros proyectos. Por lo que en pr칩ximos art칤culos estaremos abordando temas como `desarrollo de aplicaciones`. Espero que te sea de utilidad este contenido y nos vemos en el pr칩ximo cap칤tulo.


#### Recursos

- [Redis](https://redis.io/) sitio oficial
- [ACL](https://redis.io/topics/acl) Acl documentaci칩n
